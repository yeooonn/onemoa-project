<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bitcamp.onemoaproject.dao.ProductReviewDao">

    <resultMap type="productReview" id="productReviewMap">
        <id column="prno" property="no"/>
        <result column="title" property="title"/>
        <result column="cont" property="content"/>
        <result column="cdt" property="createdDate"/>
        <result column="score" property="score"/>
    </resultMap>

    <select id="findAll" parameterType="int" resultMap="productReviewMap">
        select
        pno,
        pcno,
        title,
        cont,
        price,
        vw_cnt,
        cdt,
        thumbnail,
        thumbnailpath
        from
        product p
        order by
        pno desc
    </select>

    <select id="getAverage" resultType="double">
        select
          round(avg(score), 3) average
        from
          product_review rv
        where
          pno=#{value}
    </select>

    <select id="count" resultType="java.lang.Integer">
        select
          count(*)
        from
          product_review
        where
          pno=#{value}
    </select>

</mapper>